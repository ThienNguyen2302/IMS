[{$project:{submittedYear:{$year:"$application.submittedDate"},year:"$student.currentClass.year",div:"$student.currentClass.div",dept:{$switch:{branches:[{case:{$lte:["$student.currentClass.div",4]},then:"COMP"},case:{$and:[{$gt:["$student.currentClass.div",4]},{$lt:["$student.currentClass.div",9]}],then:"IT"},{case:{$gte:["$student.currentClass.div",9]},then:"ENTC"}]}}}},{$group:{_id:{submittedYear:"$submittedYear",year:"$year",department:"$dept"},count:{$sum:1}}},{$sort:{"_id.submittedYear":1}},{$limit:8}])
